<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" type="text/css" href="style.css">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Some additional meta data possibly generated by your used Web App Manifest generator-->
  </head>
  <body>
    <head>
        <h1 class="hello">Hello World</h1>
        <h2 class="intro">This is my first ever</h2>
    </head>

    <div class="logo" id="particles-js">
      <script type="text/javascript" src="particles.js"></script>
      <script type="text/javascript" src="app.js"></script>
    </div>
      

    <script>
        if("serviceWorker" in navigator){
  navigator.serviceWorker.register("service-worker.js").then(function(registering){
    // Registration was successful
    console.log("Browser: Service Worker registration is successful with the scope",registering.scope);
  }).catch(function(error){
    //The registration of the service worker failed
    console.log("Browser: Service Worker registration failed with the error",error);
  });
}else{
  //The registration of the service worker failed
  console.log("Browser: I don't support Service Workers :(");
}

  /*Asking for permission with the Notification API*/
  if(typeof Notification!==typeof undefined){ //First check if the API is available in the browser
	Notification.requestPermission().then(function(result){ 
		//If accepted, then save subscriberinfo in database
		if(result==="granted"){
			console.log("Browser: User accepted receiving notifications, save as subscriber data!");
			navigator.serviceWorker.ready.then(function(serviceworker){ //When the Service Worker is ready, generate the subscription with our Serice Worker's pushManager and save it to our list
				const VAPIDPublicKey="BIST5mnThADZtrU8w1XYgeHD5rgZ_IkWQebwsiV1D4Tvuw0FWmGJJ6__tpJ-Oh0kzm7OWlOVsTdqWvNlIBoF7NQ"; // Fill in your VAPID publicKey here
				const options={applicationServerKey:VAPIDPublicKey,userVisibleOnly:true} //Option userVisibleOnly is neccesary for Chrome
				serviceworker.pushManager.subscribe(options).then((subscription)=>{
          //POST the generated subscription to our saving script (this needs to happen server-side, (client-side) JavaScript can't write files or databases)
					let subscriberFormData=new FormData();
					subscriberFormData.append("json", JSON.stringify(subscription));
					fetch("data/saveSubscription.php",{method:"POST",body:subscriberFormData});
				});
			});
		}
	}).catch((error)=>{
		console.log(error);
	});
}
    </script>

  </body>